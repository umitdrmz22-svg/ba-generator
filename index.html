
<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <title>Betriebsanweisung – Auswahl</title>
  <link rel="stylesheet" href="/assets/style.css" />
</head>
<body class="page">
  <div class="wrapper t-Gefahrstoff" id="indexRoot">
    <div class="hero"><h1>Betriebsanweisung – Auswahl</h1></div>

    <section class="box">
      <label>Typ wählen (optional):</label>
      <div class="row" id="typeRow">
        <label><input type="radio" name="type" value="Gefahrstoff"> Gefahrstoff</label>
        <label><input type="radio" name="type" value="Biostoff"> Biostoff</label>
        <label><input type="radio" name="type" value="Maschine" checked> Maschine</label>
        <label><input type="radio" name="type" value="PSA"> PSA</label>
      </div>
      <div class="small">Hinweis: Ohne Auswahl bleibt „Maschine“ Standard.</div>
    </section>

    <section class="box">
      <div class="grid2">
        <div>
          <label>Unternehmen (optional)</label><input id="firm" type="text" placeholder="Firmenname">
          <label>Abteilung (optional)</label><input id="dept" type="text" placeholder="Abteilung">
          <label>Ersteller (optional)</label><input id="author" type="text" placeholder="Name">
          <label>Datum (optional)</label><input id="date" type="date">
        </div>
        <div>
          <label>Logo hochladen (optional)</label>
          <input id="logoFile" type="file" accept="image/*">
          <small class="small">PNG/JPG empfohlen. Ohne Cloud-Umgebung wird der Upload übersprungen.</small>
          <div id="logoPreview" class="logo-preview"></div>
        </div>
      </div>
    </section>

    <section class="box">
      <h3>Überschrift & Typografie (optional)</h3>
      <div class="row">
        <div style="flex:1">
          <label>Name des Arbeitsmittels/Verfahrens</label>
          <input id="assetName" type="text" placeholder="z. B. Flexmaschine">
          <label>Untertitel</label>
          <input id="subtitleText" type="text" value="Betriebsanweisung">
        </div>
        <div style="flex:1">
          <label><input type="checkbox" id="subtitleBold"> Fett</label>
          <label><input type="checkbox" id="subtitleCenter" checked> Zentriert</label>
          <label>Schriftart:
            <select id="fontFamily">
              <option>Arial</option><option>Calibri</option><option>Noto Sans</option><option>Times New Roman</option>
            </select>
          </label>
          <label>Schriftgröße:
            <input type="number" id="fontSize" min="10" max="20" value="14">
          </label>
        </div>
      </div>
      <div class="small">Alle Angaben sind optional und können später im Editor geändert werden.</div>
    </section>

    <div class="actions">
      <button id="continue" class="btn-primary">Weiter zur Vorlage</button>
    </div>
  </div>

  <script type="module" src="/assets/app.js"></script>
  <!-- Fallback -->
  <script>
    (function(){
      const btn = document.getElementById('continue');
      if(!btn) return;
      btn.addEventListener('click',(e)=>{
        if(btn.dataset.bound==='1') return;
        e.preventDefault();
        const type = [...document.querySelectorAll('input[name="type"]')].find(r=>r.checked)?.value || 'Maschine';
        const head = {
          type, firm: firm?.value?.trim()||'', dept: dept?.value?.trim()||'',
          author: author?.value?.trim()||'', date: date?.value||'',
          logoUrl: window.__uploadedLogoUrl || '',
          title: {
            assetName: assetName?.value?.trim()||'',
            subtitleText: subtitleText?.value?.trim()||'Betriebsanweisung',
            bold: !!subtitleBold?.checked, center: !!subtitleCenter?.checked,
            fontFamily: fontFamily?.value||'Arial',
            fontSize: parseInt(fontSize?.value||'14',10)
          }
        };
        try { localStorage.setItem('BA_HEAD', JSON.stringify(head)); } catch {}
        location.href = 'editor.html';
      });
      const indexRoot = document.getElementById('indexRoot');
      const typeRow   = document.getElementById('typeRow');
      typeRow?.addEventListener('change',(e)=>{
        const val = e.target?.value;
        if(!val) return;
        indexRoot.classList.remove('t-Gefahrstoff','t-Biostoff','t-Maschine','t-PSA');
        indexRoot.classList.add('t-'+val);
      });
    })();
  </script>
</body>
</html>
